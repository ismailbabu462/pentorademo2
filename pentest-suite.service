[Unit]
Description=Pentest Suite Production Services
After=docker.service
Requires=docker.service

[Service]
Type=forking
User=ubuntu
Group=ubuntu
WorkingDirectory=/home/ubuntu/app
ExecStart=/usr/bin/python3 /home/ubuntu/app/start-production.py
ExecStop=/usr/bin/docker-compose -f /home/ubuntu/app/docker-compose.prod.yml --env-file /home/ubuntu/app/production.env down --remove-orphans
Restart=always
RestartSec=10
StandardOutput=journal
StandardError=journal

# Environment variables
Environment=PATH=/usr/local/bin:/usr/bin:/bin
Environment=DATABASE_URL=mysql+pymysql://pentest_user:${MYSQL_PASSWORD}@mysql:3306/pentest_suite
Environment=REDIS_URL=redis://:${REDIS_PASSWORD}@redis:6379/0

[Install]
WantedBy=multi-user.target
